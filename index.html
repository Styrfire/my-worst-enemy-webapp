<!DOCTYPE html>
<html>
	<head>
		<style>
			#input {
				width: 565px;
				padding: 10px;

				/* Center form on page horizontally & vertically*/
				margin:0 auto;
			}
		</style>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
		<script>
			$(document).ready(function()
			{
				// if user clicks submit function
				$("#submit").click(function()
				{
					window.$_GET = location.search.substr(1).split("&").reduce((o,i)=>(u=decodeURIComponent,[k,v]=i.split("="),o[u(k)]=v&&u(v),o),{});
					var summonerName = document.getElementById("text");
					console.log("summonerName.value = " + summonerName.value);

					var url = "";
					// if no url prameter exists and user pushed submit button
					if ($_GET['summonerName'] == undefined)
					{
						console.log("no url prameter exists and user pushed submit button");
						url = document.location.href + "?summonerName=" + encodeURIComponent(summonerName.value);
						console.log("url = " + url);
						window.history.pushState(null, null, url);
					}
					// if url parameter exists and person pushed submit button
					else if ($_GET['summonerName'] != undefined && urlCall == false) {
						console.log("url parameter exists and person pushed submit button");
						url = document.location.href.split("?")[0]  + "?summonerName=" + encodeURIComponent(summonerName.value);
						console.log("url = " + url);
						window.history.pushState(null, null, url);
					}
					// if url parameter exists and page was reloaded
					else
					{
						console.log("url parameter exists and page was reloaded");
						$("#text").val($_GET['summonerName'].replace("%20", " "));
					}
	
					if (summonerName.value == "")
						alert("Enter your Summoner Name!");
					else {
						var temp = "";
//						$.getJSON("http://my-worst-enemy.centralus.cloudapp.azure.com:8080/my-worst-enemy-1.0.0/topFiveChampions/" + summonerName.value,
						$.getJSON("http://localhost:8080/topFiveChampions/" + summonerName.value,
						function(data)
						{
							console.log(data);
							console.log(data["champions"].length);

							temp = temp + '<form id="topChamps" action="champInfo.html" method="GET"><input type="hidden" name="summonerName" value="' + summonerName.value + '">';
							for (i = 0; i < 5; i++)
							{
								console.log("i = " + i)
								temp = temp + '<button type="submit" name="champion" value="' + data["champions"][i]["name"] + '"><img src="' + data["champions"][i]["splashArtUrl"] + '" alt="' + data["champions"][i]["name"] + ', ' + data["champions"][i]["title"] + '" class="champion img-raised rounded-circle img-fluid"/></button>';
							}
							temp = temp + '</form>';
							console.log(temp);

							$('#content').html(temp);
							// hard coded html image content for Zann Starfire
//							$('#content').html('<form id="topChamps" action="champInfo.html" method="GET"><input type="hidden" name="summonerName" value="undefined"><button type="submit" name="champion" value="Wukong"><img src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/MonkeyKing_0.jpg" alt="Wukong, the Monkey King" class="champion img-raised rounded-circle img-fluid"/></button><button type="submit" name="champion" value="Cho'Gath"><img src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Chogath_0.jpg" alt="Cho'Gath, the Terror of the Void" class="champion img-raised rounded-circle img-fluid"/></button><button type="submit" name="champion" value="Veigar"><img src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Veigar_0.jpg" alt="Veigar, the Tiny Master of Evil" class="champion img-raised rounded-circle img-fluid"/></button><button type="submit" name="champion" value="Brand"><img src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Brand_0.jpg" alt="Brand, the Burning Vengeance" class="champion img-raised rounded-circle img-fluid"/></button><button type="submit" name="champion" value="Pantheon"><img src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Pantheon_0.jpg" alt="Pantheon, the Artisan of War" class="champion img-raised rounded-circle img-fluid"/></button></form>');
						});
					}
				});

				window.$_GET = location.search.substr(1).split("&").reduce((o,i)=>(u=decodeURIComponent,[k,v]=i.split("="),o[u(k)]=v&&u(v),o),{});
				var urlCall = false

				// if dom loads and the summonerName var is in the url, fire off the submit to load data
				if ($_GET['summonerName'] != undefined)
				{
					console.log("dom loaded and sumonerName exists");
					urlCall = true;
					$("#submit").trigger("click");
				}
				else
					console.log("summonerName doesn't exist!");
			});
		</script>
		<title>My Own Worst Enemy</title>
	</head>
	<body>
		<nav class="navbar navbar-dark bg-primary">
			<a class="navbar-brand" href="index.html">Home</a>
		</nav>

		<h1 align="center">My Own Worst Enemy</h1>
		<div id="input" class="input-group mb-3">
			<input id="text" type="text" class="form-control" name="summonerName" placeholder="Summoner Name">
			<div class="input-group-append">
				<button id="submit" class="btn btn-secondary">Submit</button>
			</div>
		</div>
		<div id="content">
<!--
			<form id="topChamps" action="champInfo.html" method="GET">
				<button type="submit" name="champion" value="Zac">
					<img id="champion" type="image" src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Zac_0.jpg" alt="Zac the Secret Weapon"/>
				</button>
				<button type="submit" name="champion" value="Nocturne">
					<img id="champion" type="image" src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Nocturne_0.jpg" alt="Nocturne the Eternal Nightmare"/>
				</button>
				<button type="submit" name="champion" value="Soraka">
					<img id="champion" type="image" src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Soraka_0.jpg" alt="Soraka the Starchild"/>
				</button>
				<button type="submit" name="champion" value="Amumu">
					<img id="champion" type="image" src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Amumu_0.jpg" alt="Amumu the Sad Mummy"/>
				</button>
				<button type="submit" name="champion" value="Vi">
					<img id="champion" type="image" src="http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Vi_0.jpg" alt="Vi the Piltover Enforcer"/>
				</button>
			</form>
-->
		</div>
	</body>
</html>